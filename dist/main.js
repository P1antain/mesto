(()=>{"use strict";class e{constructor(e,t,s){this._title=e.name,this._link=e.link,this._cardSelector=t,this._handleCardClick=s}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".element").cloneNode(!0)}generateCard(){return this._element=this._getTemplate(),this._titleElement=this._element.querySelector(".element__name"),this._imageElement=this._element.querySelector(".element__image"),this._likeButton=this._element.querySelector(".element__like"),this._deleteButton=this._element.querySelector(".element__delete"),this._setEventListeners(),this._imageElement.src=this._link,this._imageElement.alt=this._link,this._titleElement.textContent=this._title,this._element}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._like()})),this._deleteButton.addEventListener("click",(()=>{this._removeCard()})),this._imageElement.addEventListener("click",(()=>{this._handleCardClick(this._title,this._link)}))}_like(){this._likeButton.classList.toggle("element__like_active")}_removeCard(){this._element.remove(),this._element=null}}class t{constructor(e,t){this._formElement=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._popupSection=e.popupSection}_showInputError(e,t){this._errorElement=e.closest(this._popupSection).querySelector(this._inputErrorClass),this._errorElement.textContent=t,this._errorElement.classList.add(this._errorClass)}_hideInputError(e){this._errorElement=e.closest(this._popupSection).querySelector(this._inputErrorClass),this._errorElement.textContent="",this._errorElement.classList.remove(this._errorClass)}_isValid(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput(this._inputList)?(this._buttonElement.disabled=!0,this._buttonElement.classList.add(this._inactiveButtonClass)):(this._buttonElement.disabled=!1,this._buttonElement.classList.remove(this._inactiveButtonClass))}_setEventListener(){this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._isValid(e),this._toggleButtonState(this._inputList,this._buttonElement)}))})),this._formElement.addEventListener("reset",(()=>{this._inputList.forEach((e=>{this._hideInputError(e),this._toggleButtonState([{validity:{valid:!1}}],this._buttonElement)}))})),this._toggleButtonState(this._inputList,this._buttonElement)}enableValidation(){this._setEventListener()}}const s={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save",inactiveButtonClass:"popup__save_disable",inputErrorClass:".popup__input-error",errorClass:"popup__input-error_active",popupSection:".popup__section"},n=document.querySelector(".profil__edit"),i=document.querySelector(".profil__add"),r=document.querySelector(".popup__input_type_name"),o=document.querySelector(".popup__input_type_profession"),l=document.querySelector(".popup__form_profile"),p=document.querySelector(".popup__form_image");class _{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popup.addEventListener("click",(e=>{e.target.classList.contains("popup__overlay")&&this.close(e.target),e.target.classList.contains("popup__close")&&this.close()}))}}class a extends _{constructor({handleFormSubmit:e},t){super(t),this._handleFormSubmit=e}_getInputValues(){return this._inputList=this._popup.querySelectorAll(".popup__input"),this._formValues={},this._inputList.forEach((e=>this._formValues[e.name]=e.value)),this._formValues}setEventListeners(){super.setEventListeners(),this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.close()}))}close(){super.close(),this._popup.querySelector(".popup__form").reset()}}function u(t){const s=new e(t,".template",v).generateCard();c.addItem(s)}const c=new class{constructor({items:e,render:t},s){this._renderedItems=e,this._renderer=t,this._container=document.querySelector(s)}addItem(e){this._container.prepend(e)}renderItems(){this._renderedItems.forEach((e=>{this._renderer(e)}))}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],render(e){u(e)}},".elements"),h=new class{constructor(e,t){this._userNameSection=document.querySelector(e),this._userInfoSection=document.querySelector(t)}getUserInfo(){return{inputProfileName:this._userNameSection.textContent,inputProfileInfo:this._userInfoSection.textContent}}setUserInfo(e){this._userNameSection.textContent=e.inputProfileName,this._userInfoSection.textContent=e.inputProfileInfo}}(".profil__name",".profil__profession"),d=new a({handleFormSubmit:e=>{h.setUserInfo(e)}},".popup_type_add-profile");n.addEventListener("click",(()=>{d.open(),function(){const e=h.getUserInfo();r.value=e.inputProfileName,o.value=e.inputProfileInfo}()}));const m=new a({handleFormSubmit:e=>{u({name:e.editImageName,link:e.editImageSrc})}},".popup_type_add-image");i.addEventListener("click",(()=>{m.open(),p.reset()}));const E=new class extends _{constructor(e){super(e),this._title=this._popup.querySelector(".popup__name"),this._image=this._popup.querySelector(".popup__image")}open(e,t){this._title.textContent=e,this._image.src=t,this._image.alt=t,super.open()}}(".popup_type_add-card");function v(e,t){E.open(e,t)}c.renderItems(),d.setEventListeners(),m.setEventListeners(),E.setEventListeners();const S=new t(s,l);new t(s,p).enableValidation(),S.enableValidation()})();